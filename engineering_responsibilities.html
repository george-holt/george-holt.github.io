<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Engineering Responsibilities Radar Chart - George Holt"
    />
    <meta name="author" content="George Holt" />
    <meta
      name="keywords"
      content="engineering management, responsibilities, radar chart"
    />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#ffffff" />

    <title>Engineering Responsibilities Comparison</title>

    <!-- Font loading optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300"
      rel="stylesheet"
    />

    <!-- Critical CSS Inlined -->
    <style>
      html {
        font-size: 1rem;
      }
      :root {
        /* Color Palette */
        --primary-color: #007bff;
        --primary-hover: #0056b3;
        --accent-color: #0072b1;
        --text-primary: #333;
        --text-secondary: #666;
        --text-muted: #6c757d;
        --text-dark: #343a40;
        --background-primary: #ffffff;
        --background-secondary: #f8f9fa;
        --background-muted: #f1f1f1;
        --border-color: #dee2e6;

        /* Typography */
        --font-family: "Roboto", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        --font-size-base: 1.4rem;
        --font-size-sm: 1rem;
        --font-size-md: 1.5rem;
        --font-size-lg: 1.8rem;
        --font-size-xl: 2.25rem;
        --font-size-2xl: 2.5rem;
        --line-height-base: 1.6;
        --line-height-tight: 1.3;

        /* Layout Constants */
        --navbar-height: 70px;
        --footer-spacing: 30px;
        --section-padding: 50px;
        --section-margin: 32px;
        --heading-margin: 40px;
        --content-padding: 20px;
        --micro-spacing: 10px;
        --hover-offset: 5px;

        /* Component Dimensions */
        --chart-max-width: 1200px;
        --chart-min-height: 500px;
        --chart-center-min-height: 400px;
        --legend-size: 16px;

        /* Spacing */
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;

        /* Border Radius */
        --border-radius: 8px;
        --border-radius-lg: 20px;
        --border-radius-sm: calc(var(--border-radius) * 0.375);

        /* Shadows */
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
        --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 4px 8px rgba(0, 123, 255, 0.3);
        --shadow-opacity: 0.3;
        --shadow-light-opacity: 0.04;
        --shadow-medium-opacity: 0.1;

        /* Transitions */
        --transition-fast: 150ms ease-in-out;
        --transition-normal: 0.3s ease-in-out;

        /* Media Query Breakpoints */
        --breakpoint-mobile: 480px;
        --breakpoint-tablet: 768px;
        --breakpoint-desktop: 992px;
        --breakpoint-large: 1200px;

        /* Chart Configuration */
        --chart-fill-opacity: 0.2;
        --chart-border-opacity: 1;
        --chart-max-scale: 5;
        --chart-step-size: 1;
        --chart-font-size: 12;
      }

      body {
        color: var(--text-primary);
        font-family: var(--font-family);
        padding-top: var(--navbar-height);
        padding-bottom: var(--footer-spacing);
      }
      h1 {
        font-size: var(--font-size-xl);
        font-weight: 600;
      }
      h2 {
        font-size: var(--font-size-md);
        font-weight: 500;
        margin-top: var(--spacing-lg);
      }
      p,
      li {
        font-size: var(--font-size-base);
        line-height: var(--line-height-base);
      }
      .chart-container {
        max-width: var(--chart-max-width);
        margin: var(--spacing-lg) auto;
        padding: var(--spacing-sm);
        position: relative;
        height: auto;
        min-height: var(--chart-min-height);
        opacity: 0;
        transition: opacity var(--transition-normal);
      }
      .chart-container.loaded {
        opacity: 1;
      }
      .chart-layout {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
        height: auto;
      }

      .chart-center {
        order: 1;
        min-height: var(--chart-center-min-height);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .company-details {
        order: 2;
        width: 100%;
        padding: var(--spacing-xs) var(--spacing-xs);
        margin-bottom: var(--spacing-xs);
        background-color: var(--background-secondary);
        border-radius: var(--border-radius);
        border-left: calc(var(--border-radius) * 0.5) solid transparent;
        opacity: 0;
        transition: opacity var(--transition-normal);
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        contain: layout style;
      }

      .company-details.loaded {
        opacity: 1;
      }

      .company-details h4 {
        margin-top: 0;
        margin-bottom: var(--spacing-xs);
        font-size: var(--font-size-sm);
        color: var(--text-dark);
      }

      .company-description {
        font-size: var(--font-size-lg);
        line-height: var(--line-height-tight);
        color: var(--text-primary);
        margin: 0;
      }

      .chart-container .well p,
      .chart-container .well li {
        font-size: var(--font-size-lg);
        line-height: var(--line-height-tight);
      }
      .company-selector {
        margin-bottom: var(--spacing-lg);
        opacity: 0;
        transition: opacity var(--transition-normal);
      }
      .company-selector.loaded {
        opacity: 1;
      }
      .back-link {
        margin-bottom: var(--spacing-lg);
      }
      .comparison-controls {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-lg);
        flex-wrap: wrap;
      }
      .vs-label {
        font-weight: bold;
        color: var(--text-secondary);
        font-size: var(--font-size-sm);
        align-self: flex-end;
        margin-bottom: var(--spacing-xs);
      }
      .company-dropdown {
        min-width: calc(var(--spacing-sm) * 12.5);
      }
      .dropdown-container {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin-top: var(--spacing-xs);
      }
      .legend {
        display: flex;
        justify-content: center;
        gap: var(--spacing-lg);
        margin-top: var(--spacing-sm);
        flex-wrap: wrap;
      }
      .legend-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
      }
      .legend-color {
        width: var(--legend-size);
        height: var(--legend-size);
        border-radius: var(--border-radius-sm);
        flex-shrink: 0;
      }
      canvas {
        max-width: 100%;
      }
    </style>

    <!-- Load jQuery -->
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css?v=1.0" rel="stylesheet" />
    <!-- Bootstrap theme - Deferred -->
    <link
      href="css/bootstrap-theme.min.css?v=1.0"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />
    <!-- IE10 viewport hack - Deferred -->
    <link
      href="css/ie10-viewport-bug-workaround.css?v=1.0"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />

    <!-- Custom styles - Deferred -->
    <link
      href="css/custom.css?v=1.0"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />

    <script src="js/ie-emulation-modes-warning.js?v=1.0" defer></script>

    <!-- Chart.js and PapaParse for CSV handling -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <script type="text/javascript" defer>
      (function (window, document, dataLayerName, id) {
        (window[dataLayerName] = window[dataLayerName] || []),
          window[dataLayerName].push({
            start: new Date().getTime(),
            event: "stg.start",
          });
        var scripts = document.getElementsByTagName("script")[0],
          tags = document.createElement("script");
        function stgCreateCookie(a, b, c) {
          var d = "";
          if (c) {
            var e = new Date();
            e.setTime(e.getTime() + 24 * c * 60 * 60 * 1e3),
              (d = "; expires=" + e.toUTCString());
          }
          document.cookie = a + "=" + b + d + "; path=/";
        }
        var isStgDebug =
          (window.location.href.match("stg_debug") ||
            document.cookie.match("stg_debug")) &&
          !window.location.href.match("stg_disable_debug");
        stgCreateCookie("stg_debug", isStgDebug ? 1 : "", isStgDebug ? 14 : -1);
        var qP = [];
        dataLayerName !== "dataLayer" &&
          qP.push("data_layer_name=" + dataLayerName),
          isStgDebug && qP.push("stg_debug");
        var qPString = qP.length > 0 ? "?" + qP.join("&") : "";
        (tags.async = !0),
          (tags.src =
            "https://george-holt.containers.piwik.pro/" +
            id +
            ".js" +
            qPString),
          scripts.parentNode.insertBefore(tags, scripts);
        !(function (a, n, i) {
          a[n] = a[n] || {};
          for (var c = 0; c < i.length; c++)
            !(function (i) {
              (a[n][i] = a[n][i] || {}),
                (a[n][i].api =
                  a[n][i].api ||
                  function () {
                    var a = [].slice.call(arguments, 0);
                    "string" == typeof a[0] &&
                      window[dataLayerName].push({
                        event: n + "." + i + ":" + a[0],
                        parameters: [].slice.call(arguments, 1),
                      });
                  });
            })(i[c]);
        })(window, "ppms", ["tm", "cm"]);
      })(window, document, "dataLayer", "b6ca6764-4b6c-4bfe-b0a5-896cc9f6b48e");
    </script>

    <header role="banner">
      <nav role="navigation" aria-label="Main navigation">
        <div class="container">
          <div class="back-link">
            <a href="index.html" class="btn btn-default">
              <span class="glyphicon glyphicon-arrow-left"></span> Back to Home
            </a>
          </div>
        </div>
      </nav>
    </header>

    <main role="main">
      <section class="introduction" aria-labelledby="page-title">
        <div class="container">
          <header>
            <h1 id="page-title">
              What Engineering Managers Do In Different Companies
            </h1>
            <p class="lead">
              Compare how different companies emphasize various engineering
              management responsibilities.
            </p>
          </header>
        </div>
      </section>

      <section class="chart-section" aria-labelledby="chart-title">
        <div class="container">
          <div class="company-selector">
            <div class="comparison-controls">
              <div>
                <label for="companyA" class="control-label"
                  >Select up to 2 companies:</label
                >
                <div class="dropdown-container">
                  <select
                    id="companyA"
                    class="form-control company-dropdown"
                    aria-describedby="companyA-description"
                  ></select>
                  <div class="legend-item">
                    <div
                      class="legend-color"
                      style="background-color: rgba(54, 162, 235, 1)"
                      aria-label="Company A color indicator"
                    ></div>
                  </div>
                </div>
              </div>
              <div class="vs-label" aria-label="versus">vs</div>
              <div>
                <label for="companyB" class="control-label">&nbsp;</label>
                <div class="dropdown-container">
                  <select
                    id="companyB"
                    class="form-control company-dropdown"
                    aria-describedby="companyB-description"
                  ></select>
                  <div class="legend-item">
                    <div
                      class="legend-color"
                      style="background-color: rgba(255, 99, 132, 1)"
                      aria-label="Company B color indicator"
                    ></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div
            class="chart-container"
            role="region"
            aria-label="Engineering responsibilities comparison chart"
          >
            <div class="chart-layout">
              <article
                id="companyA-details"
                class="company-details"
                aria-labelledby="companyA-title"
              >
                <h4 id="companyA-title">Select a company to see details...</h4>
                <p id="companyA-description" class="company-description">
                  Choose a company from the dropdown above to view their
                  engineering management focus areas.
                </p>
              </article>
              <div class="chart-center">
                <canvas
                  id="radarChart"
                  aria-label="Radar chart showing engineering management responsibilities comparison"
                ></canvas>
              </div>
              <article
                id="companyB-details"
                class="company-details"
                aria-labelledby="companyB-title"
              >
                <h4 id="companyB-title">Select a company to see details...</h4>
                <p id="companyB-description" class="company-description">
                  Choose a company from the dropdown above to view their
                  engineering management focus areas.
                </p>
              </article>
            </div>
          </div>
        </div>
      </section>

      <section class="about-chart" aria-labelledby="about-title">
        <div class="container">
          <article class="well">
            <header>
              <h2 id="about-title">About this chart:</h2>
            </header>
            <p>
              This radar chart shows the relative emphasis (1-5 scale) that
              different companies place on various engineering management
              responsibilities. The data is based on my observations and
              experience in the industry.
            </p>
            <p><strong>What each responsibility means in practice:</strong></p>
            <ul id="responsibility-list" role="list">
              <li role="listitem">
                <strong>People Management:</strong> Hiring, performance reviews,
                career development, team building, conflict resolution, and
                organizational design. Higher scores mean more time spent on
                people vs. technical work.
              </li>
              <li role="listitem">
                <strong>Tech Strategy:</strong> Architecture decisions,
                technology choices, technical roadmap planning, and setting
                technical direction. Higher scores indicate more strategic
                technical leadership.
              </li>
              <li role="listitem">
                <strong>Execution:</strong> Project management, timeline
                tracking, resource allocation, and delivery coordination. Higher
                scores mean more hands-on project management.
              </li>
              <li role="listitem">
                <strong>Product:</strong> Product strategy, feature
                prioritization, roadmap planning, and product-market fit
                decisions. Higher scores indicate more product ownership
                responsibilities.
              </li>
              <li role="listitem">
                <strong>Customer:</strong> Direct customer interaction,
                requirements gathering, user research, and customer success.
                Higher scores mean more customer-facing responsibilities.
              </li>
              <li role="listitem">
                <strong>Quality:</strong> Code review processes, testing
                strategies, reliability engineering, and quality assurance
                oversight. Higher scores indicate stronger quality focus.
              </li>
              <li role="listitem">
                <strong>Cross-functional:</strong> Working with design,
                marketing, sales, legal, and other departments. Higher scores
                mean more cross-team collaboration.
              </li>
              <li role="listitem">
                <strong>IC Work:</strong> Hands-on coding, debugging, and
                technical implementation. Higher scores indicate more individual
                contributor responsibilities alongside management.
              </li>
              <li role="listitem">
                <strong>Tech Mentorship:</strong> Technical coaching, code
                reviews, architecture guidance, and technical skill development.
                Higher scores mean more technical teaching and mentoring.
              </li>
            </ul>
            <p>
              <strong>How to interpret the chart:</strong> A score of 1 means
              minimal emphasis, while 5 indicates heavy focus. Companies with
              higher scores in certain areas typically expect managers to spend
              more time on those responsibilities.
            </p>
          </article>
        </div>
      </section>
    </main>

    <script>
      const csvPath = "./data/engineering_responsibilities_compact.csv";

      const chartLabels = [
        "PeoplePri",
        "TechPri",
        "ExecPri",
        "ProductPri",
        "CustomerPri",
        "QualityPri",
        "XFuncPri",
        "TechConPri",
        "MentorPri",
      ];

      let chart;
      let allData = [];
      let companyDetails = {};
      let responsibilityConfig = {};

      // Load company details with error handling
      const companyDetailsPath = "./data/company_details.json";
      fetch(companyDetailsPath)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          companyDetails = data;
          // Don't update chart here - let populateSelectors handle it
        })
        .catch((error) => {
          console.error("Error loading company details:", error);
          // Continue without company details - chart will still work
          companyDetails = {};
        });

      // Parse responsibility config from CSV header
      function parseResponsibilityConfig(csvText) {
        const lines = csvText.split("\n");
        const header = lines[0];
        const columns = header.split(",");

        const config = {};
        const chartLabels = [];

        columns.forEach((column, index) => {
          if (column !== "Company" && column.trim()) {
            const displayName = column.trim();
            const key = displayName.replace(/\s+/g, ""); // Remove spaces for key

            config[key] = {
              displayName: displayName,
              description: `${displayName} responsibilities and focus areas`,
            };
            chartLabels.push(displayName);
          }
        });

        return { config, chartLabels };
      }

      // Load CSV with error handling
      const cacheBuster = "?v=1.0";
      const fullCsvPath = csvPath + cacheBuster;
      fetch(fullCsvPath)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.text();
        })
        .then((csv) => {
          Papa.parse(csv, {
            header: true,
            dynamicTyping: true,
            complete: function (results) {
              if (results.errors.length > 0) {
                console.error("CSV parsing errors:", results.errors);
              }
              if (!results.data || results.data.length === 0) {
                console.error("No data found in CSV");
                return;
              }
              allData = results.data;
              responsibilityConfig = parseResponsibilityConfig(csv).config;
              populateAboutSection();
              populateSelectors(results.data);
            },
            error: function (error) {
              console.error("PapaParse error:", error);
            },
          });
        })
        .catch((error) => {
          console.error("Error loading CSV:", error);
          // Try alternative path if first one fails
          if (csvPath.startsWith("./")) {
            const altPath = csvPath.substring(2) + cacheBuster;
            fetch(altPath)
              .then((response) => response.text())
              .then((csv) => {
                Papa.parse(csv, {
                  header: true,
                  dynamicTyping: true,
                  complete: function (results) {
                    if (results.data && results.data.length > 0) {
                      allData = results.data;
                      responsibilityConfig =
                        parseResponsibilityConfig(csv).config;
                      populateAboutSection();
                      populateSelectors(results.data);
                    }
                  },
                });
              })
              .catch((altError) => {
                console.error("Alternative path also failed:", altError);
              });
          }
        });

      // Fallback for older browsers that don't support fetch
      if (typeof fetch === "undefined") {
        console.error(
          "Fetch API not supported - this browser may not work properly"
        );
      }

      // Chart configuration constants
      const CHART_CONFIG = {
        DEFAULT_VALUE: 0,
        MAX_SCALE: 5,
        STEP_SIZE: 1,
        FONT_SIZE: 12,
        COMPANY_A_COLOR: "rgba(54, 162, 235, 1)",
        COMPANY_B_COLOR: "rgba(255, 99, 132, 1)",
        COMPANY_A_FILL: "rgba(54, 162, 235, 0.2)",
        COMPANY_B_FILL: "rgba(255, 99, 132, 0.2)",
      };

      function renderChart(companyA, companyB) {
        const ctx = document.getElementById("radarChart");
        if (!ctx) {
          console.error("Canvas element not found");
          return;
        }

        const context = ctx.getContext("2d");
        if (!context) {
          console.error("Could not get canvas context");
          return;
        }

        if (chart) {
          chart.destroy();
        }

        const datasets = [];

        // Add Company A if selected
        if (companyA) {
          const chartLabels = Object.keys(responsibilityConfig);
          const dataA = chartLabels.map((label) => {
            const displayName = responsibilityConfig[label].displayName;
            return companyA[displayName] ?? CHART_CONFIG.DEFAULT_VALUE;
          });
          datasets.push({
            label: companyA.Company,
            data: dataA,
            fill: true,
            backgroundColor: CHART_CONFIG.COMPANY_A_FILL,
            borderColor: CHART_CONFIG.COMPANY_A_COLOR,
            pointBackgroundColor: CHART_CONFIG.COMPANY_A_COLOR,
            pointBorderColor: "#fff",
            pointHoverBackgroundColor: "#fff",
            pointHoverBorderColor: CHART_CONFIG.COMPANY_A_COLOR,
          });
        }

        // Add Company B if selected
        if (companyB) {
          const chartLabels = Object.keys(responsibilityConfig);
          const dataB = chartLabels.map((label) => {
            const displayName = responsibilityConfig[label].displayName;
            return companyB[displayName] ?? CHART_CONFIG.DEFAULT_VALUE;
          });
          datasets.push({
            label: companyB.Company,
            data: dataB,
            fill: true,
            backgroundColor: CHART_CONFIG.COMPANY_B_FILL,
            borderColor: CHART_CONFIG.COMPANY_B_COLOR,
            pointBackgroundColor: CHART_CONFIG.COMPANY_B_COLOR,
            pointBorderColor: "#fff",
            pointHoverBackgroundColor: "#fff",
            pointHoverBorderColor: CHART_CONFIG.COMPANY_B_COLOR,
          });
        }

        try {
          chart = new Chart(ctx, {
            type: "radar",
            data: {
              labels: Object.values(responsibilityConfig).map(
                (r) => r.displayName
              ),
              datasets: datasets,
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: false,
                },
              },
              scales: {
                r: {
                  min: CHART_CONFIG.DEFAULT_VALUE,
                  max: CHART_CONFIG.MAX_SCALE,
                  beginAtZero: true,
                  ticks: {
                    stepSize: CHART_CONFIG.STEP_SIZE,
                    callback: function (value) {
                      return value;
                    },
                  },
                  pointLabels: {
                    font: {
                      size: CHART_CONFIG.FONT_SIZE,
                    },
                    callback: function (value) {
                      // Split long labels into multiple lines
                      const words = value.split(" ");
                      if (words.length > 1) {
                        return words;
                      }
                      return value;
                    },
                  },
                },
              },
            },
          });

          // Add loaded class immediately after chart creation
          const chartContainer = document.querySelector(".chart-container");
          if (chartContainer) {
            chartContainer.classList.add("loaded");
          }
        } catch (error) {
          console.error("Error creating chart:", error);
          // Fail quietly - just don't show the chart
        }
      }

      function populateAboutSection() {
        const list = document.getElementById("responsibility-list");
        if (!list) return;

        // Use improved descriptions instead of the repetitive ones from responsibilityConfig
        const improvedDescriptions = {
          "People Management":
            "Hiring, performance reviews, career development, team building, conflict resolution, and organizational design. Higher scores mean more time spent on people vs. technical work.",
          "Tech Strategy":
            "Architecture decisions, technology choices, technical roadmap planning, and setting technical direction. Higher scores indicate more strategic technical leadership.",
          Execution:
            "Project management, timeline tracking, resource allocation, and delivery coordination. Higher scores mean more hands-on project management.",
          Product:
            "Product strategy, feature prioritization, roadmap planning, and product-market fit decisions. Higher scores indicate more product ownership responsibilities.",
          Customer:
            "Direct customer interaction, requirements gathering, user research, and customer success. Higher scores mean more customer-facing responsibilities.",
          Quality:
            "Code review processes, testing strategies, reliability engineering, and quality assurance oversight. Higher scores indicate stronger quality focus.",
          "Cross-functional":
            "Working with design, marketing, sales, legal, and other departments. Higher scores mean more cross-team collaboration.",
          "IC Work":
            "Hands-on coding, debugging, and technical implementation. Higher scores indicate more individual contributor responsibilities alongside management.",
          "Tech Mentorship":
            "Technical coaching, code reviews, architecture guidance, and technical skill development. Higher scores mean more technical teaching and mentoring.",
        };

        list.innerHTML = "";
        Object.values(responsibilityConfig).forEach((responsibility) => {
          const li = document.createElement("li");
          const improvedDescription =
            improvedDescriptions[responsibility.displayName] ||
            responsibility.description;
          li.innerHTML = `<strong>${responsibility.displayName}:</strong> ${improvedDescription}`;
          list.appendChild(li);
        });
      }

      function populateSelectors(data) {
        const selectA = document.getElementById("companyA");
        const selectB = document.getElementById("companyB");

        if (!selectA || !selectB) {
          console.error("Company selector elements not found");
          return;
        }

        const validRows = data.filter((row) => row.Company);

        if (validRows.length === 0) {
          console.error("No valid company data found");
          // Fail quietly - just leave dropdowns empty
          return;
        }

        // Clear existing options
        selectA.innerHTML = "";
        selectB.innerHTML = "";

        validRows.forEach((row) => {
          const optA = document.createElement("option");
          optA.value = row.Company;
          optA.textContent = row.Company;
          selectA.appendChild(optA);

          const optB = document.createElement("option");
          optB.value = row.Company;
          optB.textContent = row.Company;
          selectB.appendChild(optB);
        });

        // Set default selections
        if (validRows.length >= 2) {
          selectA.value = validRows[0].Company;
          selectB.value = validRows[1].Company;
        }

        // Add event listeners
        selectA.addEventListener("change", updateChart);
        selectB.addEventListener("change", updateChart);

        // Add loaded class to company selector for fade-in
        const companySelector = document.querySelector(".company-selector");
        if (companySelector) {
          companySelector.classList.add("loaded");
        }

        // Single coordinated update: update chart and fade-in together
        updateChart();

        // Add loaded classes immediately after chart update
        const companyADetails = document.getElementById("companyA-details");
        const companyBDetails = document.getElementById("companyB-details");
        if (companyADetails) companyADetails.classList.add("loaded");
        if (companyBDetails) companyBDetails.classList.add("loaded");
      }

      function updateChart() {
        const companyA = document.getElementById("companyA")?.value || "";
        const companyB = document.getElementById("companyB")?.value || "";

        const dataA = companyA
          ? allData.find((d) => d.Company === companyA)
          : null;
        const dataB = companyB
          ? allData.find((d) => d.Company === companyB)
          : null;

        // Update company details
        updateCompanyDetails(
          "companyA-details",
          companyA,
          CHART_CONFIG.COMPANY_A_COLOR
        );
        updateCompanyDetails(
          "companyB-details",
          companyB,
          CHART_CONFIG.COMPANY_B_COLOR
        );

        // Render chart
        renderChart(dataA, dataB);
      }

      function updateCompanyDetails(elementId, companyName, color) {
        const element = document.getElementById(elementId);
        if (!element) {
          console.error(`Element ${elementId} not found`);
          return;
        }

        const titleElement = element.querySelector("h4");
        const descriptionElement = element.querySelector(
          ".company-description"
        );

        if (!titleElement || !descriptionElement) {
          console.error(`Required elements not found in ${elementId}`);
          return;
        }

        if (companyName && companyDetails[companyName]) {
          titleElement.textContent = companyName;
          titleElement.style.color = color;
          descriptionElement.textContent = companyDetails[companyName];
          element.style.borderLeftColor = color;
        } else {
          titleElement.textContent =
            elementId === "companyA-details"
              ? "Company 1 Details"
              : "Company 2 Details";
          titleElement.style.color = "#495057";
          descriptionElement.textContent = companyName
            ? `No details available for "${companyName}"`
            : "Select a company to see details...";
          element.style.borderLeftColor = "transparent";
        }
      }
    </script>

    <!-- Bootstrap core JavaScript -->
    <script>
      window.jQuery ||
        document.write('<script src="/js/vendor/jquery.min.js"><\/script>');
    </script>
    <script src="js/bootstrap.min.js?v=1.0" defer></script>
    <script src="js/docs.min.js?v=1.0" defer></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js?v=1.0" defer></script>
  </body>
</html>
