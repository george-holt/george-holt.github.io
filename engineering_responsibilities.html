<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Engineering Responsibilities Radar Chart - George Holt"
    />
    <meta name="author" content="George Holt" />
    <meta
      name="keywords"
      content="engineering management, responsibilities, radar chart"
    />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#ffffff" />

    <title>Engineering Responsibilities Comparison</title>

    <!-- Using system fonts for zero-blink rendering -->

    <!-- Critical CSS Inlined -->
    <style>
      html {
        font-size: 1rem;
      }
      :root {
        /* Color Palette */
        --primary-color: #007bff;
        --primary-hover: #0056b3;
        --accent-color: #0072b1;
        --text-primary: #333;
        --text-secondary: #3d3d3d;
        --text-muted: #555;
        --text-dark: #343a40;
        --background-primary: #ffffff;
        --background-secondary: #f8f9fa;
        --background-muted: #f1f1f1;
        --border-color: #dee2e6;

        /* Typography */
        --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        --font-size-base: 1.4rem;
        --font-size-sm: 1rem;
        --font-size-md: 1.5rem;
        --font-size-lg: 1.8rem;
        --font-size-xl: 2.25rem;
        --font-size-2xl: 2.5rem;
        --line-height-base: 1.6;
        --line-height-tight: 1.3;

        /* Layout Constants */
        --navbar-height: 70px;
        --footer-spacing: 30px;
        --section-padding: 50px;
        --section-margin: 32px;
        --heading-margin: 40px;
        --content-padding: 20px;
        --micro-spacing: 10px;
        --hover-offset: 5px;

        /* Component Dimensions */
        --chart-max-width: 1200px;
        --chart-min-height: 500px;
        --chart-center-min-height: 400px;
        --legend-size: 16px;

        /* Spacing */
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;

        /* Border Radius */
        --border-radius: 8px;
        --border-radius-lg: 20px;
        --border-radius-sm: calc(var(--border-radius) * 0.375);

        /* Shadows */
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
        --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 4px 8px rgba(0, 123, 255, 0.3);
        --shadow-opacity: 0.3;
        --shadow-light-opacity: 0.04;
        --shadow-medium-opacity: 0.1;

        /* Transitions */
        --transition-fast: 150ms ease-in-out;
        --transition-normal: 0.3s ease-in-out;

        /* Media Query Breakpoints */
        --breakpoint-mobile: 480px;
        --breakpoint-tablet: 768px;
        --breakpoint-desktop: 992px;
        --breakpoint-large: 1200px;

        /* Chart Configuration */
        --chart-fill-opacity: 0.2;
        --chart-border-opacity: 1;
        --chart-max-scale: 5;
        --chart-step-size: 1;
        --chart-font-size: 12;
        /* Chart width on larger screens */
        --chart-center-width: 60%;
      }

      body {
        color: var(--text-primary);
        font-family: var(--font-family);
        padding-top: var(--navbar-height);
        padding-bottom: var(--footer-spacing);
      }
      h1 {
        font-size: var(--font-size-xl);
        font-weight: 600;
      }
      h2 {
        font-size: var(--font-size-lg);
        font-weight: 500;
        margin-top: var(--spacing-lg);
      }
      p,
      li {
        font-size: var(--font-size-sm);
        line-height: var(--line-height-base);
      }
      /* Accessibility utilities */
      .visually-hidden {
        position: absolute !important;
        width: 1px !important;
        height: 1px !important;
        padding: 0 !important;
        margin: -1px !important;
        overflow: hidden !important;
        clip: rect(0, 0, 0, 0) !important;
        white-space: nowrap !important;
        border: 0 !important;
      }
      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #000;
        color: #fff;
        padding: 8px 12px;
        z-index: 1000;
        transition: top var(--transition-fast);
      }
      .skip-link:focus {
        top: 0;
      }
      /* Focus visibility */
      a:focus-visible,
      button:focus-visible,
      select:focus-visible,
      input:focus-visible {
        outline: 3px solid var(--accent-color);
        outline-offset: 2px;
        border-radius: 4px;
      }
      .lead {
        font-size: var(--font-size-sm);
        line-height: var(--line-height-base);
      }
      .chart-container {
        max-width: 100%;
        margin: var(--spacing-lg) auto;
        padding: var(--spacing-sm);
        position: relative;
        height: auto;
        /* Remove fixed min-height so vertical spacing tracks width */
        min-height: 0;
        opacity: 0;
        transition: opacity var(--transition-normal);
      }
      .chart-container.loaded {
        opacity: 1;
      }
      .chart-layout {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
        height: auto;
      }

      .chart-center {
        order: 1;
        /* Make chart height follow width to keep consistent spacing */
        aspect-ratio: 1 / 1;
        display: flex;
        align-items: center;
        justify-content: center;
        width: var(--chart-center-width);
        margin-left: auto;
        margin-right: auto;
        min-height: 0;
      }

      .company-details {
        order: 2;
        width: 100%;
        padding: var(--spacing-xs) var(--spacing-xs);
        margin-bottom: var(--spacing-xs);
        background-color: var(--background-secondary);
        border-radius: var(--border-radius);
        border-left: calc(var(--border-radius) * 0.5) solid transparent;
        opacity: 0;
        transition: opacity var(--transition-normal);
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        contain: layout style;
      }

      .company-details.loaded {
        opacity: 1;
      }

      .company-details h2 {
        margin-top: 0;
        margin-bottom: var(--spacing-xs);
        font-size: var(--font-size-md);
        color: var(--text-dark);
        font-weight: 600;
      }

      .company-description {
        font-size: var(--font-size-sm);
        line-height: var(--line-height-base);
        color: var(--text-primary);
        margin: 0;
      }

      .chart-container .well p,
      .chart-container .well li {
        font-size: var(--font-size-sm);
        line-height: var(--line-height-base);
      }
      .company-selector {
        margin-bottom: var(--spacing-lg);
        opacity: 0;
        transition: opacity var(--transition-normal);
      }
      .company-selector.loaded {
        opacity: 1;
      }
      .back-link {
        margin-bottom: var(--spacing-lg);
      }
      .back-link a:focus-visible {
        outline: 3px solid var(--accent-color);
        outline-offset: 3px;
        border-radius: 4px;
      }
      .comparison-controls {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-lg);
        flex-wrap: wrap;
        padding-top: var(--spacing-sm);
        width: 100%;
        max-width: var(--chart-max-width);
        margin-left: auto;
        margin-right: auto;
      }
      .vs-label {
        font-weight: bold;
        color: var(--text-secondary);
        font-size: var(--font-size-sm);
        align-self: flex-end;
        margin-bottom: var(--spacing-xs);
      }
      .company-dropdown {
        /* Static width to fit current longest names */
        width: 20ch;
        min-width: 20ch;
        max-width: 100%;
        font-size: var(--font-size-sm);
        line-height: var(--line-height-base);
      }
      .dropdown-container {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        flex: 0 1 auto;
        white-space: nowrap;
      }

      /* Desktop: Company A legend on left, Company B legend on right */
      .company-a-legend {
        order: -1;
      }
      .legend {
        display: flex;
        justify-content: center;
        gap: var(--spacing-lg);
        margin-top: var(--spacing-sm);
        flex-wrap: wrap;
      }
      .legend-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
      }
      .legend-color {
        width: var(--legend-size);
        height: var(--legend-size);
        border-radius: var(--border-radius-sm);
        flex-shrink: 0;
      }
      canvas {
        width: 100%;
        height: 100%;
        max-width: 100%;
      }

      /* Container and responsive utilities */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 15px;
      }

      /* Mobile-specific adjustments */
      @media (max-width: 768px) {
        :root {
          --font-size-base: 1.1rem;
          --font-size-md: 1.3rem;
          --font-size-xl: 1.8rem;
          --font-size-2xl: 2rem;
          --chart-min-height: 400px;
          --chart-center-min-height: 300px;
          --section-padding: 30px;
          --content-padding: 15px;
          /* On mobile, let the chart be full width */
          --chart-center-width: 100%;
        }

        .container {
          padding: 0 10px;
        }

        .chart-container {
          min-height: 0;
        }
        .chart-center {
          min-height: 0;
        }

        .comparison-controls {
          flex-direction: column;
          align-items: center;
          gap: var(--spacing-sm);
        }

        .vs-label {
          align-self: center;
          margin: 0;
        }

        .dropdown-container {
          justify-content: center;
          margin: 0;
        }

        /* On mobile, make selects full-width for usability */
        .company-dropdown {
          width: 100%;
        }

        /* Mobile: Move Company A legend back to right side when stacked */
        .company-a-legend {
          order: 1; /* Move back to right side */
        }

        /* Mobile: Add padding to control label for better spacing */
        .control-label {
          padding-bottom: var(--spacing-xs);
        }
      }

      @media (max-width: 480px) {
        :root {
          --font-size-base: 1rem;
          --font-size-md: 1.2rem;
          --font-size-xl: 1.6rem;
          --font-size-2xl: 1.8rem;
          --chart-min-height: 350px;
          --chart-center-min-height: 250px;
          --section-padding: 20px;
          --content-padding: 10px;
        }

        .container {
          padding: 0 8px;
        }
      }
    </style>

    <!-- No external CSS needed - all styles are inlined for optimal performance -->

    <!-- Chart.js and PapaParse for CSV handling (deferred to avoid render blocking) -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"
    ></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <script type="text/javascript" defer>
      (function (window, document, dataLayerName, id) {
        (window[dataLayerName] = window[dataLayerName] || []),
          window[dataLayerName].push({
            start: new Date().getTime(),
            event: "stg.start",
          });
        var scripts = document.getElementsByTagName("script")[0],
          tags = document.createElement("script");
        function stgCreateCookie(a, b, c) {
          var d = "";
          if (c) {
            var e = new Date();
            e.setTime(e.getTime() + 24 * c * 60 * 60 * 1e3),
              (d = "; expires=" + e.toUTCString());
          }
          document.cookie = a + "=" + b + d + "; path=/";
        }
        var isStgDebug =
          (window.location.href.match("stg_debug") ||
            document.cookie.match("stg_debug")) &&
          !window.location.href.match("stg_disable_debug");
        stgCreateCookie("stg_debug", isStgDebug ? 1 : "", isStgDebug ? 14 : -1);
        var qP = [];
        dataLayerName !== "dataLayer" &&
          qP.push("data_layer_name=" + dataLayerName),
          isStgDebug && qP.push("stg_debug");
        var qPString = qP.length > 0 ? "?" + qP.join("&") : "";
        (tags.async = !0),
          (tags.src =
            "https://george-holt.containers.piwik.pro/" +
            id +
            ".js" +
            qPString),
          scripts.parentNode.insertBefore(tags, scripts);
        !(function (a, n, i) {
          a[n] = a[n] || {};
          for (var c = 0; c < i.length; c++)
            !(function (i) {
              (a[n][i] = a[n][i] || {}),
                (a[n][i].api =
                  a[n][i].api ||
                  function () {
                    var a = [].slice.call(arguments, 0);
                    "string" == typeof a[0] &&
                      window[dataLayerName].push({
                        event: n + "." + i + ":" + a[0],
                        parameters: [].slice.call(arguments, 1),
                      });
                  });
            })(i[c]);
        })(window, "ppms", ["tm", "cm"]);
      })(window, document, "dataLayer", "b6ca6764-4b6c-4bfe-b0a5-896cc9f6b48e");
    </script>

    <header role="banner">
      <nav role="navigation" aria-label="Main navigation">
        <div class="container">
          <div class="back-link">
            <a href="index.html" class="btn btn-default">
              <span class="glyphicon glyphicon-arrow-left"></span> Back to Home
            </a>
          </div>
        </div>
      </nav>
    </header>

    <main role="main" id="main-content">
      <section class="introduction" aria-labelledby="page-title">
        <div class="container">
          <header>
            <h1 id="page-title">
              What Engineering Managers Do In Different Companies
            </h1>
            <p class="lead">
              Compare how different companies emphasize various engineering
              management responsibilities.
            </p>
          </header>
        </div>
      </section>

      <section class="chart-section" aria-labelledby="chart-title">
        <div class="container">
          <div class="company-selector">
            <p id="company-help" class="control-label">
              Select up to 2 companies:
            </p>
            <div class="comparison-controls">
              <div class="dropdown-container">
                <div class="legend-item company-a-legend">
                  <div
                    class="legend-color"
                    style="background-color: rgba(54, 162, 235, 1)"
                    aria-hidden="true"
                  ></div>
                  <span class="visually-hidden">Company A color</span>
                </div>
                <label for="companyA" class="visually-hidden"
                  >First company</label
                >
                <select
                  id="companyA"
                  class="form-control company-dropdown"
                  aria-describedby="company-help companyA-description"
                ></select>
              </div>
              <div class="vs-label" role="separator" aria-hidden="true">vs</div>
              <div class="dropdown-container">
                <label for="companyB" class="visually-hidden"
                  >Second company</label
                >
                <select
                  id="companyB"
                  class="form-control company-dropdown"
                  aria-describedby="company-help companyB-description"
                ></select>
                <div class="legend-item">
                  <div
                    class="legend-color"
                    style="background-color: rgba(255, 99, 132, 1)"
                    aria-hidden="true"
                  ></div>
                  <span class="visually-hidden">Company B color</span>
                </div>
              </div>
            </div>
          </div>

          <div
            class="chart-container"
            role="region"
            aria-label="Engineering responsibilities comparison chart"
          >
            <div class="chart-layout">
              <article
                id="companyA-details"
                class="company-details"
                aria-labelledby="companyA-title"
                aria-live="polite"
              >
                <h2 id="companyA-title">Select a company to see details...</h2>
                <p id="companyA-description" class="company-description">
                  Choose a company from the dropdown above to view their
                  engineering management focus areas.
                </p>
              </article>
              <div class="chart-center">
                <p id="chart-desc" class="visually-hidden" aria-live="polite">
                  Radar chart comparing selected companies across engineering
                  management responsibilities.
                </p>
                <canvas
                  id="radarChart"
                  role="img"
                  aria-describedby="chart-desc"
                  aria-label="Engineering responsibilities comparison chart"
                ></canvas>
              </div>
              <article
                id="companyB-details"
                class="company-details"
                aria-labelledby="companyB-title"
                aria-live="polite"
              >
                <h2 id="companyB-title">Select a company to see details...</h2>
                <p id="companyB-description" class="company-description">
                  Choose a company from the dropdown above to view their
                  engineering management focus areas.
                </p>
              </article>
            </div>
          </div>
        </div>
      </section>

      <section class="about-chart" aria-labelledby="about-title">
        <div class="container">
          <article class="well">
            <header>
              <h2 id="about-title">About this chart:</h2>
            </header>
            <p>
              This radar chart shows the relative emphasis (1-5 scale) that
              different companies place on various engineering management
              responsibilities. The data is based on data collected from open
              job descriptions in the last 12 months, blogs, published articles,
              and my own personal observations. I know each role varies over
              time and from team to team, so please keep in mind that this is a
              generalization.
            </p>
            <p>
              If you think this is wrong, please correct me by taking this
              <a href="https://forms.gle/opvPotKjoY26Hjj96">survey</a>
            </p>
            <p><strong>What each responsibility means in practice:</strong></p>
            <ul id="responsibility-list" role="list">
              <li role="listitem">
                <strong>People Management:</strong> Hiring, coaching, team
                morale, performance management, and career development. This
                includes work like holding 1:1s or skip-levels, giving feedback,
                writing promotion reviews, on-boarding new hires, developing
                retention strategies, and resolving interpersonal issues.
              </li>
              <li role="listitem">
                <strong>Technical Strategy:</strong> Architecture decisions,
                technology choices, technical roadmap planning, and setting
                technical direction.
              </li>
              <li role="listitem">
                <strong>Execution:</strong> Making sure the team ships work
                predictably and meets deadlines. This includes estimating and
                tracking work, managing scope and dependencies, unblocking
                engineers, and handling timeline or risk escalations.
              </li>
              <li role="listitem">
                <strong>Product:</strong> Working with product managers and
                designers (or on your own) to define what gets built and why.
                This includes aligning on goals and priorities, product/market
                fit decisions, reviewing PRDs and design mocks, negotiating
                tradeoffs, and defining the product roadmap.
              </li>
              <li role="listitem">
                <strong>Customer:</strong> Understanding and representing the
                needs of users. This includes analyzing customer feedback,
                reviewing usage and satisfaction metrics, participating in user
                research or interviews, and prioritizing work based on customer
                impact.
              </li>
              <li role="listitem">
                <strong>Quality and Operational Excellence:</strong> Ensuring
                code quality, system reliability, and a smooth development
                process and release process. This includes promoting test
                coverage, driving on-call health and postmortems, addressing
                technical debt, and improving build and deployment workflows.
                Code review processes, testing strategies, reliability
                engineering, and quality assurance oversight.
              </li>
              <li role="listitem">
                <strong>Cross-functional:</strong> Coordinating across
                organizations, functions, and teams to get things done. This
                includes working with Security, Legal, Infra, QA, Sales, or
                other departments; running cross-team meetings; representing
                your team in reviews; and leading org-wide initiatives.
              </li>
              <li role="listitem">
                <strong>IC Work:</strong>Direct technical involvement through
                writing, reviewing, or debugging code. This includes reviewing
                pull requests, writing code or prototypes, debugging hard
                issues, or jumping into design sessions as a hands-on
                contributor. There some engineering managers who still build
                major features to stay connected to the craft.
              </li>
              <li role="listitem">
                <strong>Tech Mentorship:</strong> Technical coaching, code
                reviews, architecture guidance, and technical skill development.
                Higher scores mean more technical teaching and mentoring.
              </li>
            </ul>
            <p>
              <strong>How to interpret the chart:</strong> A score of 1 means
              minimal emphasis, while 5 indicates heavy focus. Companies with
              higher scores in certain areas typically expect managers to spend
              more time on those responsibilities.
            </p>
          </article>
        </div>
      </section>
    </main>

    <script>
      (function () {
        const onReady = function () {
          // Build populates COMPANY_ROWS and COMPANY_DETAILS as inline consts

          const chartLabels = [
            "PeoplePri",
            "TechPri",
            "ExecPri",
            "ProductPri",
            "CustomerPri",
            "QualityPri",
            "XFuncPri",
            "TechConPri",
            "MentorPri",
          ];

          let chart;
          let allData = [];
          let companyDetails = {};
          let responsibilityConfig = {};

          // Chart configuration constants (must be defined before first use)
          const CHART_CONFIG = {
            DEFAULT_VALUE: 0,
            MAX_SCALE: 5,
            STEP_SIZE: 1,
            FONT_SIZE: 12,
            COMPANY_A_COLOR: "rgba(54, 162, 235, 1)",
            COMPANY_B_COLOR: "rgba(255, 99, 132, 1)",
            COMPANY_A_FILL: "rgba(54, 162, 235, 0.2)",
            COMPANY_B_FILL: "rgba(255, 99, 132, 0.2)",
          };

          // Load embedded data synchronously from script tags
          try {
            const detailsEl = document.getElementById("company-details-json");
            if (detailsEl && detailsEl.textContent) {
              companyDetails = JSON.parse(detailsEl.textContent);
            }
          } catch (_) {
            companyDetails = {};
          }
          try {
            const rowsEl = document.getElementById("company-rows-json");
            if (rowsEl && rowsEl.textContent) {
              allData = JSON.parse(rowsEl.textContent);
            }
          } catch (_) {
            allData = [];
          }

          // Parse responsibility config from CSV header
          function parseResponsibilityConfig(csvText) {
            const lines = csvText.split("\n");
            const header = lines[0];
            const columns = header.split(",");

            const config = {};
            const chartLabels = [];

            columns.forEach((column, index) => {
              if (column !== "Company" && column.trim()) {
                const displayName = column.trim();
                const key = displayName.replace(/\s+/g, ""); // Remove spaces for key

                config[key] = {
                  displayName: displayName,
                  description: `${displayName} responsibilities and focus areas`,
                };
                chartLabels.push(displayName);
              }
            });

            return { config, chartLabels };
          }

          // Fallback CSV parser (no external lib needed)
          function toRows(csvText) {
            if (!csvText) return [];
            const lines = csvText
              .replace(/\r/g, "\n")
              .split(/\n+/)
              .filter(Boolean);
            if (lines.length === 0) return [];
            const headers = lines[0].split(",").map((h) => h.trim());
            const rows = [];
            for (let i = 1; i < lines.length; i++) {
              const cols = lines[i].split(",");
              if (!cols[0]) continue;
              const row = {};
              for (let j = 0; j < headers.length; j++) {
                const key = headers[j];
                const raw = (cols[j] ?? "").trim();
                const asNum = raw === "" ? raw : Number(raw);
                row[key] = Number.isFinite(asNum) ? asNum : raw;
              }
              rows.push(row);
            }
            return rows;
          }

          // Use embedded data if present; otherwise fallback to files in dist/data
          (async function initData() {
            if (allData && allData.length > 0) {
              const header = Object.keys(allData[0]).join(",");
              responsibilityConfig = parseResponsibilityConfig(header).config;
              populateAboutSection();
              populateSelectors(allData);
              return;
            }

            try {
              const [detailsResp, csvResp] = await Promise.all([
                fetch("./data/company_details.json").catch(() => null),
                fetch("./data/engineering_responsibilities_compact.csv").catch(
                  () => null
                ),
              ]);

              if (detailsResp && detailsResp.ok) {
                companyDetails = await detailsResp.json();
              }
              if (csvResp && csvResp.ok) {
                const csvText = await csvResp.text();
                allData = toRows(csvText);
                const header =
                  csvText.split("\n")[0] ||
                  Object.keys(allData[0] || {}).join(",");
                responsibilityConfig = parseResponsibilityConfig(header).config;
                populateAboutSection();
                populateSelectors(allData);
              }
            } catch (_) {
              // Fail quietly
            }
          })();

          // Fallback for older browsers that don't support fetch
          if (typeof fetch === "undefined") {
            console.error(
              "Fetch API not supported - this browser may not work properly"
            );
          }

          // (moved CHART_CONFIG earlier)

          function ensureChartLoaded() {
            return new Promise((resolve, reject) => {
              if (window.Chart) return resolve();
              const s = document.createElement("script");
              s.src = "vendor/chart.min.js";
              s.defer = true;
              s.onload = () => resolve();
              s.onerror = (e) => reject(e);
              document.head.appendChild(s);
            });
          }

          async function renderChart(companyA, companyB) {
            try {
              await ensureChartLoaded();
            } catch (_) {
              return;
            }
            if (window.Chart && Chart.defaults) {
              Chart.defaults.animation = false;
            }
            const ctx = document.getElementById("radarChart");
            if (!ctx) {
              console.error("Canvas element not found");
              return;
            }

            const context = ctx.getContext("2d");
            if (!context) {
              console.error("Could not get canvas context");
              return;
            }

            if (chart) {
              chart.destroy();
            }

            const datasets = [];

            // Match axis label font size to body text size
            let axisFontSizePx = 14; // fallback
            try {
              const samplePara = document.querySelector("p");
              const computed = window.getComputedStyle(
                samplePara || document.body
              );
              const sizeStr =
                computed && computed.fontSize ? computed.fontSize : "14px";
              const parsed = parseFloat(sizeStr);
              if (!Number.isNaN(parsed) && parsed > 0) {
                axisFontSizePx = parsed;
              }
            } catch (_) {
              // keep fallback
            }

            // Add Company A if selected
            if (companyA) {
              const chartLabels = Object.keys(responsibilityConfig);
              const dataA = chartLabels.map((label) => {
                const displayName = responsibilityConfig[label].displayName;
                return companyA[displayName] ?? CHART_CONFIG.DEFAULT_VALUE;
              });
              datasets.push({
                label: companyA.Company,
                data: dataA,
                fill: true,
                backgroundColor: CHART_CONFIG.COMPANY_A_FILL,
                borderColor: CHART_CONFIG.COMPANY_A_COLOR,
                pointBackgroundColor: CHART_CONFIG.COMPANY_A_COLOR,
                pointBorderColor: "#fff",
                pointHoverBackgroundColor: "#fff",
                pointHoverBorderColor: CHART_CONFIG.COMPANY_A_COLOR,
              });
            }

            // Add Company B if selected
            if (companyB) {
              const chartLabels = Object.keys(responsibilityConfig);
              const dataB = chartLabels.map((label) => {
                const displayName = responsibilityConfig[label].displayName;
                return companyB[displayName] ?? CHART_CONFIG.DEFAULT_VALUE;
              });
              datasets.push({
                label: companyB.Company,
                data: dataB,
                fill: true,
                backgroundColor: CHART_CONFIG.COMPANY_B_FILL,
                borderColor: CHART_CONFIG.COMPANY_B_COLOR,
                pointBackgroundColor: CHART_CONFIG.COMPANY_B_COLOR,
                pointBorderColor: "#fff",
                pointHoverBackgroundColor: "#fff",
                pointHoverBorderColor: CHART_CONFIG.COMPANY_B_COLOR,
              });
            }

            try {
              chart = new Chart(ctx, {
                type: "radar",
                data: {
                  labels: Object.values(responsibilityConfig).map(
                    (r) => r.displayName
                  ),
                  datasets: datasets,
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  animation: false,
                  plugins: {
                    legend: {
                      display: false,
                    },
                  },
                  scales: {
                    r: {
                      min: CHART_CONFIG.DEFAULT_VALUE,
                      max: CHART_CONFIG.MAX_SCALE,
                      beginAtZero: true,
                      ticks: {
                        stepSize: CHART_CONFIG.STEP_SIZE,
                        font: { size: axisFontSizePx },
                        callback: function (value) {
                          return value;
                        },
                      },
                      pointLabels: {
                        font: { size: axisFontSizePx },
                        callback: function (value) {
                          // Split long labels into multiple lines
                          const words = value.split(" ");
                          if (words.length > 1) {
                            return words;
                          }
                          return value;
                        },
                      },
                    },
                  },
                },
              });

              // Add loaded class immediately after chart creation
              const chartContainer = document.querySelector(".chart-container");
              if (chartContainer) {
                chartContainer.classList.add("loaded");
              }
            } catch (error) {
              console.error("Error creating chart:", error);
              // Fail quietly - just don't show the chart
            }
          }

          function populateAboutSection() {
            const list = document.getElementById("responsibility-list");
            if (!list) return;

            // Use improved descriptions instead of the repetitive ones from responsibilityConfig
            const improvedDescriptions = {
              "People Management":
                "Hiring, performance reviews, career development, team building, conflict resolution, and organizational design. Higher scores mean more time spent on people vs. technical work.",
              "Tech Strategy":
                "Architecture decisions, technology choices, technical roadmap planning, and setting technical direction. Higher scores indicate more strategic technical leadership.",
              Execution:
                "Project management, timeline tracking, resource allocation, and delivery coordination. Higher scores mean more hands-on project management.",
              Product:
                "Product strategy, feature prioritization, roadmap planning, and product-market fit decisions. Higher scores indicate more product ownership responsibilities.",
              Customer:
                "Direct customer interaction, requirements gathering, user research, and customer success. Higher scores mean more customer-facing responsibilities.",
              Quality:
                "Code review processes, testing strategies, reliability engineering, and quality assurance oversight. Higher scores indicate stronger quality focus.",
              "Cross-functional":
                "Working with design, marketing, sales, legal, and other departments. Higher scores mean more cross-team collaboration.",
              "IC Work":
                "Hands-on coding, debugging, and technical implementation. Higher scores indicate more individual contributor responsibilities alongside management.",
              "Tech Mentorship":
                "Technical coaching, code reviews, architecture guidance, and technical skill development. Higher scores mean more technical teaching and mentoring.",
            };

            list.innerHTML = "";
            Object.values(responsibilityConfig).forEach((responsibility) => {
              const li = document.createElement("li");
              const improvedDescription =
                improvedDescriptions[responsibility.displayName] ||
                responsibility.description;
              li.innerHTML = `<strong>${responsibility.displayName}:</strong> ${improvedDescription}`;
              list.appendChild(li);
            });
          }

          function populateSelectors(data) {
            const selectA = document.getElementById("companyA");
            const selectB = document.getElementById("companyB");

            if (!selectA || !selectB) {
              console.error("Company selector elements not found");
              return;
            }

            const validRows = data.filter((row) => row.Company);

            if (validRows.length === 0) {
              console.error("No valid company data found");
              // Fail quietly - just leave dropdowns empty
              return;
            }

            // Clear existing options
            selectA.innerHTML = "";
            selectB.innerHTML = "";

            validRows.forEach((row) => {
              const optA = document.createElement("option");
              optA.value = row.Company;
              optA.textContent = row.Company;
              selectA.appendChild(optA);

              const optB = document.createElement("option");
              optB.value = row.Company;
              optB.textContent = row.Company;
              selectB.appendChild(optB);
            });

            // Set default selections
            if (validRows.length >= 2) {
              selectA.value = validRows[0].Company;
              selectB.value = validRows[1].Company;
            }

            // Add event listeners
            selectA.addEventListener("change", updateChart);
            selectB.addEventListener("change", updateChart);

            // Add loaded class to company selector for fade-in
            const companySelector = document.querySelector(".company-selector");
            if (companySelector) {
              companySelector.classList.add("loaded");
            }

            // Single coordinated update: update chart and fade-in together
            updateChart();

            // Size dropdowns to fit the longest company name (desktop/tablet only)
            try {
              if (
                !window.matchMedia ||
                !window.matchMedia("(max-width: 768px)").matches
              ) {
                const selectTexts = Array.from(validRows, (r) =>
                  String(r.Company || "")
                );
                const measureEl = document.createElement("span");
                measureEl.style.visibility = "hidden";
                measureEl.style.whiteSpace = "nowrap";
                // Use same font as form controls
                const sampleSelect = selectA || selectB;
                if (sampleSelect) {
                  const cs = window.getComputedStyle(sampleSelect);
                  measureEl.style.font = `${cs.fontStyle} ${cs.fontVariant} ${cs.fontWeight} ${cs.fontSize} / ${cs.lineHeight} ${cs.fontFamily}`;
                }
                document.body.appendChild(measureEl);
                let maxPx = 0;
                for (const txt of selectTexts) {
                  measureEl.textContent = txt;
                  maxPx = Math.max(maxPx, measureEl.offsetWidth);
                }
                document.body.removeChild(measureEl);
                // Add padding and arrow allowance, and cap to a reasonable width
                const widthPx = Math.min(maxPx + 56, 480);
                if (selectA) selectA.style.width = `${widthPx}px`;
                if (selectB) selectB.style.width = `${widthPx}px`;
              }
            } catch (_) {
              // Ignore sizing errors
            }

            // Add loaded classes immediately after chart update
            const companyADetails = document.getElementById("companyA-details");
            const companyBDetails = document.getElementById("companyB-details");
            if (companyADetails) companyADetails.classList.add("loaded");
            if (companyBDetails) companyBDetails.classList.add("loaded");
          }

          function scheduleRender(a, b) {
            const runner = () => renderChart(a, b);
            if ("requestIdleCallback" in window) {
              requestIdleCallback(runner, { timeout: 2000 });
            } else {
              setTimeout(runner, 0);
            }
          }

          function updateChart() {
            const companyA = document.getElementById("companyA")?.value || "";
            const companyB = document.getElementById("companyB")?.value || "";

            const dataA = companyA
              ? allData.find((d) => d.Company === companyA)
              : null;
            const dataB = companyB
              ? allData.find((d) => d.Company === companyB)
              : null;

            // Update company details
            updateCompanyDetails(
              "companyA-details",
              companyA,
              CHART_CONFIG.COMPANY_A_COLOR
            );
            updateCompanyDetails(
              "companyB-details",
              companyB,
              CHART_CONFIG.COMPANY_B_COLOR
            );

            // Render chart (scheduled to reduce main-thread contention)
            scheduleRender(dataA, dataB);
          }

          function updateCompanyDetails(elementId, companyName, color) {
            const element = document.getElementById(elementId);
            if (!element) {
              console.error(`Element ${elementId} not found`);
              return;
            }

            const titleId =
              elementId === "companyA-details"
                ? "companyA-title"
                : "companyB-title";
            const titleElement = document.getElementById(titleId);
            const descriptionElement = element.querySelector(
              ".company-description"
            );

            if (!titleElement || !descriptionElement) {
              console.error(`Required elements not found in ${elementId}`);
              return;
            }

            if (companyName && companyDetails[companyName]) {
              titleElement.textContent = companyName;
              titleElement.style.color = color;
              descriptionElement.textContent = companyDetails[companyName];
              element.style.borderLeftColor = color;
            } else {
              titleElement.textContent =
                elementId === "companyA-details"
                  ? "Company 1 Details"
                  : "Company 2 Details";
              titleElement.style.color = "#495057";
              descriptionElement.textContent = companyName
                ? `No details available for "${companyName}"`
                : "Select a company to see details...";
              element.style.borderLeftColor = "transparent";
            }
          }
        };
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", onReady);
        } else {
          onReady();
        }
      })();
    </script>

    <!-- Chart.js and other dependencies are loaded in the head section -->
  </body>
</html>
